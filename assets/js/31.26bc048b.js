(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{630:function(s,t,a){s.exports=a.p+"assets/img/webpack-plugin-001.bcbcb6bc.png"},631:function(s,t,a){s.exports=a.p+"assets/img/webpack-plugin-002.37f2527f.png"},746:function(s,t,a){"use strict";a.r(t);var n=a(13),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"loader的链式调用与执行顺序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#loader的链式调用与执行顺序"}},[s._v("#")]),s._v(" loader的链式调用与执行顺序")]),s._v(" "),n("ul",[n("li",[s._v("loader执行的顺序是在use数组内从右到左（从后往前），loader本质上是一个函数。")]),s._v(" "),n("li",[s._v("多个loader是串行执行，上一个loader处理完source之后会把处理结果传给下一个loader来处理。")]),s._v(" "),n("li",[s._v("Compose(webpack采用的函数组合)："),n("code",[s._v("compose = (f, g) => (...args) => f(g(...args))")])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" newSource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"loader-runner"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#loader-runner"}},[s._v("#")]),s._v(" loader-runner")]),s._v(" "),n("p",[s._v("loader-runner运行你在不安装webpack的情况下运行loaders，进行loader的开发和调试，其实像是提供了一个loader运行的环境。")]),s._v(" "),n("h3",{attrs:{id:"手写loader"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写loader"}},[s._v("#")]),s._v(" 手写loader")]),s._v(" "),n("ul",[n("li",[s._v("Webpack5在loader的上下文中，会带有内置的this.getOptions方法。")])]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/izph/webpack-study",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack-study"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"手写插件plugin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写插件plugin"}},[s._v("#")]),s._v(" 手写插件plugin")]),s._v(" "),n("p",[s._v("插件没有像loader那样的独立运行的环境，只能在webpack里面使用。")]),s._v(" "),n("h3",{attrs:{id:"写插件的基本结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写插件的基本结构"}},[s._v("#")]),s._v(" 写插件的基本结构")]),s._v(" "),n("ul",[n("li",[s._v("webpack运行插件，会调用插件上的apply方法，同时把webpack的compiler对象传递给插件。插件可以通过compiler里的hooks的方法，在不同的阶段，做很多事情，可以监听compiler的hooks\n"),n("img",{attrs:{src:a(630),alt:"image.png"}})])]),s._v(" "),n("h3",{attrs:{id:"搭建插件的运行环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#搭建插件的运行环境"}},[s._v("#")]),s._v(" 搭建插件的运行环境")]),s._v(" "),n("p",[n("img",{attrs:{src:a(631),alt:"image.png"}})]),s._v(" "),n("h3",{attrs:{id:"插件的错误处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件的错误处理"}},[s._v("#")]),s._v(" 插件的错误处理")]),s._v(" "),n("h4",{attrs:{id:"参数校验阶段可以直接throw的方式抛出"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参数校验阶段可以直接throw的方式抛出"}},[s._v("#")]),s._v(" 参数校验阶段可以直接throw的方式抛出")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" Error Message"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"通过compilation对象的warnings和errors接收"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过compilation对象的warnings和errors接收"}},[s._v("#")]),s._v(" 通过compilation对象的warnings和errors接收")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("compilation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("warnings"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"warning"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ncompilation"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("errors"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"通过compilation进行文件写如入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过compilation进行文件写如入"}},[s._v("#")]),s._v(" 通过Compilation进行文件写如入")]),s._v(" "),n("ul",[n("li",[s._v("Compilation 上的assets可以用于文件写入，可以将zip资源包设置到compilation.assets对象上")]),s._v(" "),n("li",[s._v("文件的写入可以使用webpack-sources这个依赖包"),n("a",{attrs:{href:"https://github.com/webpack/webpack-sources",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack-sources"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"编写一个压缩构建资源为zip包的插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写一个压缩构建资源为zip包的插件"}},[s._v("#")]),s._v(" 编写一个压缩构建资源为zip包的插件")]),s._v(" "),n("ul",[n("li",[s._v("生成的zip包文件名称可以通过插件传入")]),s._v(" "),n("li",[s._v("需要使用compiler对象上特定的hooks进行资源的生成（不使用node内置的fs模块）")])]),s._v(" "),n("h3",{attrs:{id:"node-js里如何将文件压缩为一个zip包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js里如何将文件压缩为一个zip包"}},[s._v("#")]),s._v(" node.js里如何将文件压缩为一个zip包")]),s._v(" "),n("p",[s._v("使用jszip："),n("a",{attrs:{href:"https://github.com/Stuk/jszip",target:"_blank",rel:"noopener noreferrer"}},[s._v("jszip"),n("OutboundLink")],1)]),s._v(" "),n("h4",{attrs:{id:"jszip使用示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jszip使用示例"}},[s._v("#")]),s._v(" jszip使用示例")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://stuk.github.io/jszip/",target:"_blank",rel:"noopener noreferrer"}},[s._v("jszip官网"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" zip "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JSZip")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 添加文件file，文件名称，文件内容")]),s._v("\nzip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello.txt"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 生成images目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" img "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" zip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("folder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"images"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nimg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"smile.gif"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" imgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("base64")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把内容写进去")]),s._v("\nzip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("generateAsync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blob"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("content")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// see FileSaver.js")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("saveAs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"example.zip"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\nResults in a zip containing\nHello.txt\nimages/\n    smile.gif\n*/")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h3",{attrs:{id:"compiler上复制文件生成的hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#compiler上复制文件生成的hooks"}},[s._v("#")]),s._v(" compiler上复制文件生成的hooks")]),s._v(" "),n("p",[s._v("emit，是一个异步的hook，emit生成文件阶段，读取的是compilation.assets对象的值，可以将zip资源包设置到compilation.assets对象上")])])}),[],!1,null,null,null);t.default=e.exports}}]);